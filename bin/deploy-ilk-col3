#!/usr/bin/env bash

# shellcheck source=bin/lib/common.sh
. "${LIB_DIR:-$(cd "${0%/*}/lib"&&pwd)}/common.sh"

export ETH_FROM=${ETH_FROM:-$(seth rpc eth_coinbase)}

dappBuild

export ETH_NONCE=$(seth nonce $ETH_FROM)

test -z "$COL3" && COL3=$(dapp create Token3 "$(seth --to-uint256 "$(seth --to-wei 1000000 ETH)")") && ETH_NONCE="$(($ETH_NONCE + 1))"
export ETH_NONCE
test -z "$PIP_COL3" && PIP_COL3=$(dapp create DSValue) && ETH_NONCE="$(($ETH_NONCE + 1))"
export ETH_NONCE
export COL3
export PIP_COL3

# shellcheck source=/dev/null
source "$BIN_DIR/deploy-ilk" "COL3" "${1:-"A"}" "GemJoin2"
